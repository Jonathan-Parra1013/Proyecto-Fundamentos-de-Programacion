#IMPORTAMOS LIBRERIA PANDAS
import pandas as pd 

BASE_DATOS = pd.read_excel('data/TABLAPREMIER.xlsx', sheet_name='Hoja2')

Nombre_Equipos = BASE_DATOS["Equipo"].unique()
print("Los Equipos que jugaron en la PREMIER LEAGUE (2024-2025) ")
print("En orden alfabetico son: ")
for Orden_Equipo in sorted(Nombre_Equipos):
    print("-",Orden_Equipo)

#Solicitaremos al USUARIO el equipo que desea ver sus JUGADORES
def Jugadores_Equipo():
    while True:
        Solicitud_Equipo = input("Ingrese el nombre del equipo que desea ver sus jugadores - (PARA SALIR INGRESE 'fin'): ")
        if Solicitud_Equipo.lower() == "fin":
            print("Gracias por usar nuestro programa! Hasta Luego :) ")
            break
        elif Solicitud_Equipo in Nombre_Equipos:
            Jugadores = BASE_DATOS[BASE_DATOS["Equipo"].str.lower() == Solicitud_Equipo.lower()]
            
            if len(Jugadores) > 0:
                print("Los JUGADORES del equipo: ", Solicitud_Equipo, "son: ")
                for _, Jugador in Jugadores.iterrows():
                     print("-", Jugador["Nombre"], "(", Jugador["Posicion"], ")", "#", Jugador["Dorsal"])

Jugadores_Equipo()